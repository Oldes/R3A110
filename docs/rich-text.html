<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><style type="text/css">@media screen { h1,h2,h3,h4,h5,p,a,br,li,td, .underline {font-family:Arial, Helvetica, sans-serif;text-align:justify} hr {text-align:center} p,table {margin-left: 10px;margin-right:10px} .defword {white-space:nowrap} .deftable {border-style:none;vertical-align:top} .deftablefaq {border-style:solid;border-width:thin} .end {font-size:8pt} .example {margin-left:50px;margin-right:50px;border:2px solid;padding: 10px;background-color:#EEEEEE} .header {margin-left:50px;margin-right:50px;border:2px solid;padding: 10px;background-color:yellow} .indented {margin-left: 50px} .litable {text-align:left} .new {border-right: 10px solid; padding-right: 10px; font-family:Arial} .note {margin-left:50px;margin-right:50px;border:2px solid;padding: 10px;background-color:#F0F0D0} .tocindent {margin-left: 20px} .top {font-size:8pt;text-align:right} .underline {text-decoration:underline} } @media print { h1,h2,h3,h4,h5,p,a,br,li, #underline {font-family:Arial;text-align:justify;orphans:5;widows:5} p,li,td {font-size:10pt} ul,ol {page-break-after:avoid;orphans:5;widows:5} }</style><title>Proposal of Rich-Text dialect</title></head><body><a id="top" name="top"></a><h2>Proposal of Rich-Text dialect</h2><pre class="header"><strong>    Author: Richard Smolak
    Date: 19-Oct-2010
    Version: 0.0.8</strong></pre><hr /><h2>Contents</h2><div class="tocindent"><a href="#sect1"><strong>1. Purpose</strong></a><br /><a href="#sect2"><strong>2. Overview</strong></a><br /><a href="#sect3"><strong>3. Font object</strong></a><br /><div class="tocindent"><a href="#sect3.1"><strong>3.1 Attributes</strong></a><br /></div><a href="#sect4"><strong>4. Paragraph object</strong></a><br /><div class="tocindent"><a href="#sect4.1"><strong>4.1 Attributes</strong></a><br /><a href="#sect4.2"><strong>4.2 Multiple paragraphs</strong></a><br /><a href="#sect4.3"><strong>4.3 Paragraph layout example</strong></a><br /></div><a href="#sect5"><strong>5. Basic commands</strong></a><br /><div class="tocindent"><a href="#sect5.1"><strong>5.1 FONT</strong></a><br /><a href="#sect5.2"><strong>5.2 GOB</strong></a><br /><a href="#sect5.3"><strong>5.3 NEWLINE / NL</strong></a><br /><a href="#sect5.4"><strong>5.4 PARA</strong></a><br /><a href="#sect5.5"><strong>5.5 TEXT</strong></a><br /></div><a href="#sect6"><strong>6. Commands applied to whole GOB</strong></a><br /><div class="tocindent"><a href="#sect6.1"><strong>6.1 ANTI-ALIAS</strong></a><br /><a href="#sect6.2"><strong>6.2 BOTTOM</strong></a><br /><a href="#sect6.3"><strong>6.3 CARET</strong></a><br /><a href="#sect6.4"><strong>6.4 COLUMNS</strong></a><br /><a href="#sect6.5"><strong>6.5 MARGIN</strong></a><br /><a href="#sect6.6"><strong>6.6 MIDDLE</strong></a><br /><a href="#sect6.7"><strong>6.7 ORIGIN</strong></a><br /><a href="#sect6.8"><strong>6.8 SCROLL</strong></a><br /><a href="#sect6.9"><strong>6.9 TOP</strong></a><br /></div><a href="#sect7"><strong>7. Shortcut commands (related to FONT or PARA attributes)</strong></a><br /><div class="tocindent"><a href="#sect7.1"><strong>7.1 BOLD / B</strong></a><br /><a href="#sect7.2"><strong>7.2 CENTER</strong></a><br /><a href="#sect7.3"><strong>7.3 COLOR</strong></a><br /><a href="#sect7.4"><strong>7.4 DROP</strong></a><br /><a href="#sect7.5"><strong>7.5 ITALIC / I</strong></a><br /><a href="#sect7.6"><strong>7.6 JUSTIFY</strong></a><br /><a href="#sect7.7"><strong>7.7 LEFT</strong></a><br /><a href="#sect7.8"><strong>7.8 RIGHT</strong></a><br /><a href="#sect7.9"><strong>7.9 EFFECT</strong></a><br /><a href="#sect7.10"><strong>7.10 SIZE</strong></a><br /><a href="#sect7.11"><strong>7.11 UNDERLINE / U</strong></a><br /></div><a href="#sect8"><strong>8. 'Native' functions related to the text handling</strong></a><br /><div class="tocindent"><a href="#sect8.1"><strong>8.1 SIZE-TEXT</strong></a><br /><a href="#sect8.2"><strong>8.2 FONT-METRICS</strong></a><br /><a href="#sect8.3"><strong>8.3 LINE-METRICS</strong></a><br /><a href="#sect8.4"><strong>8.4 GLYPH-METRICS</strong></a><br /><a href="#sect8.5"><strong>8.5 OFFSET-TO-CARET</strong></a><br /><a href="#sect8.6"><strong>8.6 CARET-TO-OFFSET</strong></a><br /></div></div><h2><a id="sect1" name="sect1">1. Purpose</a></h2><p>The purpose of this document is to describe the Richt Text Dialect (RTD).</p><p>NOTE: This document contains changes and additions that are not implemented in current version of RTD (based on R3 A107 state).</p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect2" name="sect2">2. Overview</a></h2><p>The goal of text rendering in Rebol3 is to be able control:</p><ul><li>Font attributes</li><li>Paragraph attributes</li><li>Scrolling of text</li><li>Selection of text range</li><li>Position of text cursor</li><li>Text alignment</li><li>Text rendering quality</li><li>Embedded GOB containers in text</li></ul><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect3" name="sect3">3. Font object</a></h2><p>Use FONT command with font object argument to define Font attributes used by following text. The font object prototype definition is:</p><pre class="example">    system/standard/font: make object! [
        name: [string!]
        style: [word! block!]
        size: [integer!]
        color: [tuple!]
        bg-color: [tuple! none!]
        effect: [block! none!]
    ]</pre><h3><a id="sect3.1" name="sect3.1">3.1 Attributes</a></h3><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>name</strong></td><td style="vertical-align:top;text-align:justify"><p>name of the font</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>style</strong></td><td style="vertical-align:top;text-align:justify"><p>one word or block! of following keywords BOLD, ITALIC, UNDERINE</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>size</strong></td><td style="vertical-align:top;text-align:justify"><p>font size in pixels</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>color</strong></td><td style="vertical-align:top;text-align:justify"><p>RGBA text color value</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>effect</strong></td><td style="vertical-align:top;text-align:justify"><p>block! of text effect dialect that can be applied. (Currently only SHADOW command is supported. See below.)</p></td></tr></table></p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect4" name="sect4">4. Paragraph object</a></h2><p>Use PARA command with paragraph object argument to define Paragraph attributes which will be used for the following text. The paragraph object prototype definition is:</p><pre class="example">    system/standard/para: make object! [
        indent: [pair!]
        tabs: [integer! block!]
        wrap?: [logic!]
        align: [word!]
        space: [pair!]
        kerning: [logic!]
        run-around: [logic!]
    ]</pre><h3><a id="sect4.1" name="sect4.1">4.1 Attributes</a></h3><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>indent</strong></td><td style="vertical-align:top;text-align:justify"><p>indentation of the first line in paragraph (horizontal value) and between previous paragraph (vertical value)</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>tabs</strong></td><td style="vertical-align:top;text-align:justify"><p>width or block of positions used for the TAB character indentation</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>wrap?</strong></td><td style="vertical-align:top;text-align:justify"><p>turns on/off line wrapping of text</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>align</strong></td><td style="vertical-align:top;text-align:justify"><p>specifies horizontal text align within the bounds of the paragraph box. Avaliabe words LEFT, RIGHT, CENTER, JUSTIFY</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>space</strong></td><td style="vertical-align:top;text-align:justify"><p>a pair! specifying glyph(horizontal value) and line(vertical value) spacing</p></td></tr></table></p><p><table width="85%" class="deftable"><tr><td style="vertical-align:top" class="defword" width="25%"><strong>run-around</strong></td><td style="vertical-align:top;text-align:justify"><p>turns on/off paragraph text content runaround GOBs.</p></td></tr></table></p><h3><a id="sect4.2" name="sect4.2">4.2 Multiple paragraphs</a></h3><p>It is possible to have multiple paragraphs defined in one Rich Text block.</p><p>Paragraphs are positioned one ofter another vertically. Vertical space between pargraphs is defined by PARA/INDENT/Y values.</p><p>Use COLUMNS command(see below) to define how many paragraph columns should be used for paragraph layout.</p><p>When the paragraph text reaches bottom boundary of the GOB defined by MARGIN keyword:</p><ul><li> the rest of the text overflows and no COLUMNS command is defined or COLUMNS = 1</li></ul><p>or</p><ul><li> the rest of text is wrapped into the next paragraph column if COLUMNS &gt; 1</li></ul><h3><a id="sect4.3" name="sect4.3">4.3 Paragraph layout example</a></h3><p>The image below shows example of 2 columns paragraph layout in a text gob.</p><p><img src="paragraphs.png" alt="paragraphs.png"/></p><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect5" name="sect5">5. Basic commands</a></h2><h3><a id="sect5.1" name="sect5.1">5.1 FONT</a></h3><p>Sets font attributes.</p><p>The syntax of the command:</p><pre class="example">    FONT font-attributes [object!] </pre><h3><a id="sect5.2" name="sect5.2">5.2 GOB</a></h3><p>Renders GOB embedded in text.</p><p>The syntax of the command:</p><pre class="example">    GOB gob [gob!] </pre><h3><a id="sect5.3" name="sect5.3">5.3 NEWLINE / NL</a></h3><p>Breaks the text line.</p><p>The syntax of the command:</p><pre class="example">    NEWLINE</pre><h3><a id="sect5.4" name="sect5.4">5.4 PARA</a></h3><p>Sets paragraph attributes.</p><p>The syntax of the command:</p><pre class="example">    PARA para-attributes [object!] </pre><h3><a id="sect5.5" name="sect5.5">5.5 TEXT</a></h3><p>Renders text string.</p><p>The syntax of the command:</p><pre class="example">    TEXT text [string!] </pre><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect6" name="sect6">6. Commands applied to whole GOB</a></h2><h3><a id="sect6.1" name="sect6.1">6.1 ANTI-ALIAS</a></h3><p>Sets aliasing mode of rendered text in a GOB.</p><p>The syntax of the command:</p><pre class="example">    ANTI-ALIAS state [logic!] </pre><h3><a id="sect6.2" name="sect6.2">6.2 BOTTOM</a></h3><p>Sets text vertical alignment.</p><p>The syntax of the command:</p><pre class="example">    BOTTOM</pre><h3><a id="sect6.3" name="sect6.3">6.3 CARET</a></h3><p>Sets caret and text selection attributes.</p><p>The syntax of the command:</p><pre class="example">    CARET caret-attributes [object!]</pre><p>The caret-attributes object contains:</p><pre class="example">    make object! [
        caret: [block!] ;contains pair of text block! at the string element position and string! at the character position
        caret-shape: [block! none!] ;optional DRAW dialect based graphicsused for custom caret shape
        caret-color: [tuple! none!] ;optional color for the default caret
        highlight-start: [block!] ;contains pair of text block! at the string element position and string! at the character position
        highlight-end: [block!] ;contains pair of text block! at the string element position and string! at the character position
        highlight-color: [tuple! none!] ;optional color for the selection filled area
        highlight-text-color: [tuple! none!] ;optional color for the text inside selection area
    ]</pre><h3><a id="sect6.4" name="sect6.4">6.4 COLUMNS</a></h3><p>It is possible to define number of columns in the GOB that will be used for vertical paragraph text wrapping.</p><p>The syntax of the command:</p><pre class="example">    COLUMNS cols [integer!] </pre><h3><a id="sect6.5" name="sect6.5">6.5 MARGIN</a></h3><p>Defines bottom-right offset used for limiting the text from bottom and righ-tmost side of the GOB.</p><p>The syntax of the command:</p><pre class="example">    MARGIN offset [pair!] </pre><h3><a id="sect6.6" name="sect6.6">6.6 MIDDLE</a></h3><p>Sets text vertical alignment.</p><p>The syntax of the command:</p><pre class="example">    MIDDLE</pre><h3><a id="sect6.7" name="sect6.7">6.7 ORIGIN</a></h3><p>Defines top-left offset used for each pargraph text column in a GOB.</p><p>The syntax of the command:</p><pre class="example">    ORIGIN offset [pair!] </pre><h3><a id="sect6.8" name="sect6.8">6.8 SCROLL</a></h3><p>Scrolls the whole GOB content by amount of pixels in specific direction(s).</p><p>The syntax of the command:</p><pre class="example">    SCROLL offset [pair!] </pre><h3><a id="sect6.9" name="sect6.9">6.9 TOP</a></h3><p>Sets text vertical alignment.</p><p>The syntax of the command:</p><pre class="example">    TOP</pre><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect7" name="sect7">7. Shortcut commands (related to FONT or PARA attributes)</a></h2><h3><a id="sect7.1" name="sect7.1">7.1 BOLD / B</a></h3><p>Sets font BOLD style.</p><p>The syntax of the command:</p><pre class="example">    BOLD state [logic!] 
    or
    B state [logic!] </pre><h3><a id="sect7.2" name="sect7.2">7.2 CENTER</a></h3><p>Sets text horizontal alignment.</p><p>The syntax of the command:</p><pre class="example">    CENTER</pre><h3><a id="sect7.3" name="sect7.3">7.3 COLOR</a></h3><p>Sets font RGBA color.</p><p>The syntax of the command:</p><pre class="example">    COLOR font-color [tuple!]</pre><h3><a id="sect7.4" name="sect7.4">7.4 DROP</a></h3><p>Removes N previous style settings from the command stack.</p><p>The syntax of the command:</p><pre class="example">    DROP n [integer!]</pre><h3><a id="sect7.5" name="sect7.5">7.5 ITALIC / I</a></h3><p>Sets font ITALIC style.</p><p>The syntax of the command:</p><pre class="example">    ITALIC state [logic!] 
    or
    I state [logic!] </pre><h3><a id="sect7.6" name="sect7.6">7.6 JUSTIFY</a></h3><p>Sets text horizontal alignment.</p><p>The syntax of the command:</p><pre class="example">    JUSTIFY</pre><h3><a id="sect7.7" name="sect7.7">7.7 LEFT</a></h3><p>Sets text horizontal alignment.</p><p>The syntax of the command:</p><pre class="example">    LEFT</pre><h3><a id="sect7.8" name="sect7.8">7.8 RIGHT</a></h3><p>Sets text horizontal alignment.</p><p>The syntax of the command:</p><pre class="example">    RIGHT</pre><h3><a id="sect7.9" name="sect7.9">7.9 EFFECT</a></h3><p>Enables effect for text. (such as SHADOW..others can be added later)</p><p>The syntax of the command:</p><pre class="example">    EFFECT [block!]</pre><p>The syntax of different effects:</p><pre class="example">    SHADOW offset [pair!] color [tuple!] spread [integer!] </pre><h3><a id="sect7.10" name="sect7.10">7.10 SIZE</a></h3><p>Sets font size in pixels.</p><p>The syntax of the command:</p><pre class="example">    SIZE font-size [integer!]</pre><h3><a id="sect7.11" name="sect7.11">7.11 UNDERLINE / U</a></h3><p>Sets font UNDERLINE style.</p><p>The syntax of the command:</p><pre class="example">    UNDERLINE state [logic!] 
    or
    U state [logic!] </pre><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><h2><a id="sect8" name="sect8">8. 'Native' functions related to the text handling</a></h2><h3><a id="sect8.1" name="sect8.1">8.1 SIZE-TEXT</a></h3><p>Returns the size of text rendered by given font.</p><p>The syntax of the command:</p><pre class="example">    SIZE-TEXT text [string!] font [object!] /WRAP width [integer!]</pre><h3><a id="sect8.2" name="sect8.2">8.2 FONT-METRICS</a></h3><p>Returns metrics information related to given font.</p><p>The syntax of the command:</p><pre class="example">    FONT-METRICS font [object!]</pre><p>Returned object:</p><pre class="example">    make object! [
        ascent: [integer!] ;the distance from the font's baseline to the top of most alphanumeric characters
        descent: [integer!] ;the distance from the font's baseline to the bottom of most alphanumeric characters with descenders
        leading: [integer!] ;amount of space to be reserved between the descent of one line of text and the ascent of the next line
    ]</pre><h3><a id="sect8.3" name="sect8.3">8.3 LINE-METRICS</a></h3><p>Returns metrics information related to given line of text rendered in the graphics object.</p><p>The syntax of the command:</p><pre class="example">    LINE-METRICS gob [object!] element [integer! block!] position [integer! string!]</pre><p>Returned object:</p><pre class="example">    make object! [
        ascent: [integer!] ;the distance from the font's baseline to the top of most alphanumeric characters
        descent: [integer!] ;the distance from the font's baseline to the bottom of most alphanumeric characters with descenders
        leading: [integer!] ;amount of space to be reserved between the descent of one line of text and the ascent of the next line
    ]</pre><h3><a id="sect8.4" name="sect8.4">8.4 GLYPH-METRICS</a></h3><p>Returns metrics information related to given glyph.</p><p>The syntax of the command:</p><pre class="example">    GLYPH-METRICS text [char! string!] font [object!]</pre><p>Returned object:</p><pre class="example">    make object! [
        advance: [pair!] ; the raw distance(without kerning or other adjustments) from the glyph's origin to the origin of the next glyph
        bounds: [block!] ; rectangle that completely contains the outline of the glyph
        kerning: [pair!] ; additional kerning distance (depends on the previous glyph)
    ]</pre><h3><a id="sect8.5" name="sect8.5">8.5 OFFSET-TO-CARET</a></h3><p>Returns the richtext block at the string position for an XY offset in the graphics object.</p><p>The syntax of the command:</p><pre class="example">    OFFSET-TO-CARET gob [object!] position [pair!]</pre><h3><a id="sect8.6" name="sect8.6">8.6 CARET-TO-OFFSET</a></h3><p>Returns the xy offset (pair) for a specific string position in the graphics object.</p><p>The syntax of the command:</p><pre class="example">    CARET-TO-OFFSET gob [object!] element [integer! block!] position [integer! string!]</pre><div class="top">[ <a href="#top">back to top</a> ]</div><hr /><p class="end">Document formatter copyright <a href="http://www.robertmuench.de">Robert M. M&uuml;nch</a>. All Rights Reserved.<br />XHTML 1.0 Transitional formatted with Make-Doc-Pro Version:1.2.0 on 19-Oct-2010 at 17:35:50</p></body></html>